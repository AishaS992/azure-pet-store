<!doctype html>
<html lang="en">

<head lang="en" th:replace="fragments/head :: head"></head>

<body>
	<div lang="en" th:replace="fragments/header :: header"></div>

	<style>
	</style>

	<iframe id="soulmachines" th:src="@{'https://azurepetstore.com/static/index.html?sid=' + ${sid} + '&csrf=' + ${_csrf.token}}" style="overflow: hidden; top:0; left:0; bottom:0; right:0; width:100%; height:522px; border:none; margin:0; padding:0;"  scrolling="no">
		Your browser doesn't support iframes
	</iframe>
		
	</div>

	<div lang="en" th:replace="fragments/footersoulmachines :: footer"></div>
	
	<!--
	<div lang="en" th:replace="fragments/footer :: footer"></div>
	<div lang="en" th:replace="fragments/disclaimer :: disclaimer"></div>
	-->

	<style>
		@keyframes expandAndReturn {
			0% { transform: scale(1); }
			50% { transform: scale(2.0); }
			100% { transform: scale(1); display: none; }
		  }
	</style>

	<script src="https://code.jquery.com/jquery-3.7.0.js"></script>
	<script>
		function addToCart(url, productId){
			var session = url.split("sid=")[1].split("&")[0];
			var csrf = url.split("csrf=")[1];

			// make ajax call to add product to cart and add custom headers
			$.ajax({
			 url: 'https://azurepetstore.com/api/updatecart?csrf='+csrf+'&productId=' + productId,
			 headers: { 'Cookie': 'JSESSIONID='+session, 'Content-Type': 'text/html'},
			 type: 'GET',
			 success: function(data){
			  console.log("added to cart: " + productId);
			  cartcount();
			 }
			});
		}

		function cartcount(){
			$.ajax({
			 url: 'api/cartcount',
			 type: 'GET',
			 success: function(size){
			  var oldsize = $( "#cartcount" ).html();
			  console.log("cart count: " + size);
			  $( "#cartcount" ).html(size);
			  if (size != oldsize) {
				$("#cartcontainer").css( "animation-name", "expandAndReturn" );
				$("#cartcontainer").css( "animation-duration", "2s" );
			  }
			  else
			  {
				$("#cartcontainer").removeAttr("style");
			  }
			 }
			});
		   }
		   
		   $(document).ready(function(){
			setInterval(cartcount,5000);
		   });
	</script>

</body>

</html>